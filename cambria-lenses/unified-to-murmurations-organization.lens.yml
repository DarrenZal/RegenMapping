# Safe Cambria lens for unified-to-murmurations organization conversion
# Uses only reliable operations that preserve data

schemaName: Organization

lens:
  # Essential for lossless recovery
  - optionalRename:
      source: "@id"
      destination: "source_url"
  
  # Extra fields to include (camelCase to snake_case transformations)
  - optionalRename:
      source: "geographicScope"
      destination: "geographic_scope"
  - optionalRename:
      source: "domainTags"
      destination: "domain_tags"
  - optionalRename:
      source: "methodTags"
      destination: "method_tags"
  - optionalRename:
      source: "sdgFocus"
      destination: "sdg_focus"
  - optionalRename:
      source: "keyActivities"
      destination: "key_activities"
  - optionalRename:
      source: "employeeRange"
      destination: "employee_range"
  
  # Geolocation transformation for Murmurations compatibility
  - in:
      name: "geolocation"
      lens:
        - optionalRename:
            source: "latitude"
            destination: "lat"
        - optionalRename:
            source: "longitude"
            destination: "lon"
  
  # Set linked_schemas to Murmurations schema
  - setValue:
      name: "linked_schemas"
      value: ["organizations_schema-v1.0.0"]
  
  # Remove JSON-LD fields for Murmurations compatibility
  - remove:
      name: "@type"
  - remove:
      name: "@context"
  - remove:
      name: "schema:version"
  
  # Remove unwanted fields for clean Murmurations profile
  - remove:
      name: "relationships"
  - remove:
      name: "tagline"
  - remove:
      name: "mission"
  - remove:
      name: "legalType"
  - remove:
      name: "foundedYear"
  - remove:
      name: "lastUpdated"